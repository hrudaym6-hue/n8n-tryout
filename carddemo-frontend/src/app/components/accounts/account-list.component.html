<div class="page-container">
  <div class="page-header">
    <h1>Account Management</h1>
    <a routerLink="/dashboard" class="back-btn">‚Üê Back to Dashboard</a>
  </div>

  <div class="search-section">
    <div class="search-box">
      <label for="accountId">Search by Account ID:</label>
      <div class="search-input-group">
        <input
          type="text"
          id="accountId"
          [(ngModel)]="searchAccountId"
          placeholder="Enter 11-digit account number"
          maxlength="11"
          (keyup.enter)="onSearch()"
        />
        <button class="search-btn" (click)="onSearch()" [disabled]="isLoading()">Search</button>
        <button class="clear-btn" (click)="onClearSearch()" [disabled]="isLoading()">Clear</button>
      </div>
    </div>
  </div>

  @if (errorMessage()) {
    <div class="error-alert">{{ errorMessage() }}</div>
  }

  @if (isLoading()) {
    <div class="loading">Loading accounts...</div>
  } @else {
    @if (accounts().length === 0) {
      <div class="no-results">
        <p>No accounts found.</p>
      </div>
    } @else {
      <div class="results-info">
        <p>Showing {{ accounts().length }} of {{ totalRecords() }} accounts</p>
      </div>

      <div class="table-container">
        <table class="data-table">
          <thead>
            <tr>
              <th>Account ID</th>
              <th>Customer Name</th>
              <th>Status</th>
              <th>Current Balance</th>
              <th>Credit Limit</th>
              <th>Available Credit</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            @for (account of accounts(); track account.account_id) {
              <tr>
                <td>{{ account.account_id }}</td>
                <td>{{ account.first_name }} {{ account.last_name }}</td>
                <td>
                  <span [class]="account.account_status === 'Y' ? 'status-active' : 'status-inactive'">
                    {{ getStatusLabel(account.account_status) }}
                  </span>
                </td>
                <td>{{ formatCurrency(account.current_balance) }}</td>
                <td>{{ formatCurrency(account.credit_limit) }}</td>
                <td>{{ formatCurrency(account.credit_limit - account.current_balance) }}</td>
                <td>
                  <button class="action-btn" (click)="viewAccount(account.account_id)">View Details</button>
                </td>
              </tr>
            }
          </tbody>
        </table>
      </div>

      <div class="pagination">
        <button (click)="previousPage()" [disabled]="currentPage() === 1">Previous</button>
        <span>Page {{ currentPage() }} of {{ totalPages() }}</span>
        <button (click)="nextPage()" [disabled]="currentPage() === totalPages()">Next</button>
      </div>
    }
  }
</div>
